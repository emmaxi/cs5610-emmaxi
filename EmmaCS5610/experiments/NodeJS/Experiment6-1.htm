<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Experiment6-1</title>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container">
<h1>How to use NodeJS and Express framework to create and publish website?</h1>
<h3>Test Here:</h3>
<a href="http://nodejs-emmaxi.rhcloud.com/index-exp1.htm" target="_blank">the show page of this experiment(Include notes)</a>
<hr />
        <p>
            The purpose of this experiment is to use NodeJS and Express framework to create and publish the website.
        </p>
        <p>
            First of all,we install the nodejs and install the relative package such as Express, body-parser and multer. And then import
            them to the js file.
        </p>
        <pre>
            var express = require('express');
            var app = express();

            var bodyParser = require('body-parser');
            var multer = require('multer');

            app.use(bodyParser.json());
            app.use(bodyParser.urlencoded({extended: true}));
            app.use(multer());
        </pre>
        <p>Secondly, implement the front-end page and the relative code in js file. Including add city, delete city, edit city.</p>
        <pre>
            &lt;table class=&quot;table table-striped&quot;&gt;
         &lt;thead&gt;
           &lt;tr&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.name&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.country&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.temperature&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.weather&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.wind&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.humidity&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
                 &lt;input ng-model=&quot;city.event&quot; class=&quot;form-control&quot; /&gt;
              &lt;/th&gt;
              &lt;th&gt;
               &lt;button ng-click=&quot;update(city)&quot; class=&quot;btn btn-primary pull-right&quot;&gt;
                  &lt;span class=&quot;glyphicon glyphicon-ok&quot;&gt;&lt;/span&gt;
               &lt;/button&gt;
                 &lt;button ng-click=&quot;add(city)&quot; class=&quot;btn btn-success pull-right&quot;&gt;
                  &lt;span class=&quot;glyphicon glyphicon-plus&quot;&gt;&lt;/span&gt;
               &lt;/button&gt;
              &lt;/th&gt;
           &lt;/tr&gt;
         &lt;/thead&gt;
         &lt;tbody&gt;
           &lt;tr ng-repeat=&quot;city in cities&quot;&gt;
            &lt;td&gt;{{city.name}}&lt;/td&gt;
            &lt;td&gt;{{city.country}}&lt;/td&gt;
            &lt;td&gt;{{city.temperature}}&lt;/td&gt;
            &lt;td&gt;{{city.weather}}&lt;/td&gt;
            &lt;td&gt;{{city.wind}}&lt;/td&gt;
            &lt;td&gt;{{city.humidity}}&lt;/td&gt;
            &lt;td&gt;{{city.event}}&lt;/td&gt;
            &lt;td&gt;
              &lt;button ng-click=&quot;select($index)&quot; class=&quot;btn btn-warning pull-right&quot;&gt;
                  &lt;span class=&quot;glyphicon glyphicon-pencil&quot;&gt;&lt;/span&gt;
               &lt;/button&gt;
               &lt;button ng-click=&quot;remove($index)&quot; class=&quot;btn btn-danger pull-right&quot;&gt;
                  &lt;span class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;/span&gt;
               &lt;/button&gt;
            &lt;/td&gt;
           &lt;/tr&gt;
         &lt;/tbody&gt;
      &lt;/table&gt;
        </pre>
        <p>Last, redefine the get,post,put,delete method in server side</p>
        <pre>
        app.post("/city", function(req,res) {
           var obj = req.body;
           cities.push(obj);
           res.json(cities);
        });

        app.put("/city/:id", function(req,res){
          cities[req.params.id] = req.body;
          res.json(cities);
        });

        app.delete("/city/:id",function(req,res){
            var index = req.params.id;
            cities.splice(index,1);
            res.json(cities);
        });

        app.get("/city", function (req, res) {
            res.json(cities);
        });

        app.get("/city/:index", function (req, res) {
            var idx = req.params.index;
            res.json(cities[idx]);
        });

        app.get("/city/:index/event", function (req, res) {
            var idx = req.params.index;
            res.json(cities[idx].event);
        });

        app.get("/city/:index/event/:eventIndex", function (req, res) {
            var idx = req.params.index;
            var eidx = req.params.eventIndex;
            res.json(cities[idx].event[eidx]);
        });
        </pre>
  <hr/>
 
  <h2>relative code</h2>
   <a href="../../fileview/Default.aspx?~/experiments/NodeJS/Experiment6-1.htm" target="_blank">Experiment6-1 Html Source</a><br />
   <a href="../../fileview/Default.aspx?~/experiments/NodeJS/js/serverApp1.js" target="_blank">Experiment6-1 Server Side Source</a><br />
   <a href="../../fileview/Default.aspx?~/experiments/NodeJS/js/public/clientApp.js" target="_blank">Experiment6-1 Client Side Source</a><br />
  <h3>References:</h3>
    <a href="http://expressjs.com/4x/api.html" target="_blank">Express framework</a><br />
 <footer>Copyright by Xi Wang</footer>
</body>
</html>
